<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"
"http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<link rel="stylesheet" href="style.css" type="text/css">
<title>viper_cert.html</title>
</head>
<body>
<div class="why3doc">
<pre><span class="keyword">module</span> <a name="Sum_">Sum</a>
  <span class="keyword">use</span> int.<a href="int.html#Int_">Int</a>
  <span class="keyword">use</span> real.<a href="real.html#Real_">Real</a>
  <span class="keyword">use</span> real.<a href="real.html#RealInfix_">RealInfix</a>

  <span class="keyword">let</span> <span class="keyword">rec</span> <span class="keyword">ghost</span> <span class="keyword">function</span> <a name="sum_6">sum</a> (f: int -&gt; real) (a b: int) : real
    <span class="keyword">requires</span> { Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) a b }
    <span class="keyword">variant</span> { Int.(<a href="int.html#infix%20-_23">-</a>) b a }
  = <span class="keyword">if</span> a <a href="int.html#infix%20=_16">=</a> b <span class="keyword">then</span> 0.0 <span class="keyword">else</span> f a <a href="real.html#infix%20+._69">+.</a> sum f (a <a href="int.html#infix%20+_19">+</a> 1) b

<span class="keyword">end</span>

<span class="keyword">theory</span> <a name="Init_">Init</a>

  <span class="keyword">use</span>  int.<a href="int.html#Int_">Int</a>
  <span class="keyword">use</span>  array.<a href="array.html#Array_">Array</a>

  <span class="keyword">function</span> <a name="init_19">init</a> (n: int) (f: int -&gt; real) : <a href="array.html#array_15">array</a> real

  <span class="keyword">axiom</span> <a name="init_spec'lemma_21">init_spec</a>:
    <span class="keyword">forall</span> f n. n <a href="int.html#infix%20%3E=_26">&gt;=</a> 0 -&gt;
      (<span class="keyword">forall</span> i. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> i <a href="int.html#infix%20%3C_21">&lt;</a> n -&gt; (<a href="#init_19">init</a> n f)[i] = f i) /\
      <a href="array.html#length_17">length</a> (<a href="#init_19">init</a> n f) = n

<span class="keyword">end</span>

<span class="keyword">theory</span> <a name="VIPRCertificate_">VIPRCertificate</a>

  <span class="keyword">use</span> int.<a href="int.html#Int_">Int</a>
  <span class="keyword">use</span> int.<a href="int.html#Lex2_">Lex2</a>
  <span class="keyword">use</span> real.<a href="real.html#Real_">Real</a>
  <span class="keyword">use</span> real.<a href="real.html#RealInfix_">RealInfix</a>
  <span class="keyword">use</span> real.<a href="real.html#FromInt_">FromInt</a>
  <span class="keyword">use</span> array.<a href="array.html#Array_">Array</a>
  <span class="keyword">use</span> set.<a href="set.html#Set_">Set</a>
  <span class="keyword">use</span> <a href="#Sum_">Sum</a>

  <span class="keyword">predicate</span> <a name="is_integer_39">is_integer</a> (x: real) =
    <span class="keyword">exists</span> i: int. x = <a href="real.html#from_int_129">from_int</a> i

  <span class="comment">(* ---------- Type and constants ---------- *)</span>

  <span class="comment">(* Dimensions of the certificate *)</span>
  <span class="keyword">constant</span> <a name="n_45">n</a> : int   <span class="comment">(* number of variables *)</span>
  <span class="keyword">constant</span> <a name="m_46">m</a> : int   <span class="comment">(* number of original constraints *)</span>
  <span class="keyword">constant</span> <a name="d_47">d</a> : int   <span class="comment">(* total number of constraints *)</span>

  <span class="comment">(* Dimension assumptions *)</span>
  <span class="keyword">axiom</span> <a name="H_con'lemma_50">H_con</a> : Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) 0 <a href="#m_46">m</a> /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> <a href="#d_47">d</a>
  <span class="keyword">axiom</span> <a name="H_var'lemma_51">H_var</a> : Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) <a href="#n_45">n</a> 0

  <span class="comment">(* Basic types *)</span>
  <span class="keyword">type</span> <a name="sign_54">sign</a> =
    | <a name="Leq_55">Leq</a>
    | <a name="Geq_56">Geq</a>
    | <a name="Eq_57">Eq</a>

  <span class="keyword">function</span> <a name="sign_to_int_59">sign_to_int</a> (s: <a href="#sign_54">sign</a>) : int

  <span class="keyword">axiom</span> <a name="sign_to_int_def'lemma_61">sign_to_int_def</a>:
  <span class="keyword">forall</span> s: <a href="#sign_54">sign</a>.
    (s = <a href="#Leq_55">Leq</a> -&gt; <a href="#sign_to_int_59">sign_to_int</a> s = -1) /\
    (s = <a href="#Eq_57">Eq</a>  -&gt; <a href="#sign_to_int_59">sign_to_int</a> s =  0) /\
    (s = <a href="#Geq_56">Geq</a> -&gt; <a href="#sign_to_int_59">sign_to_int</a> s =  1)

  <span class="keyword">type</span> <a name="constraint_67">constraint</a> = {
    <a name="a_68">a</a> : <a href="array.html#array_15">array</a> real;
    <a name="b_69">b</a> : real;
    <a name="s_70">s</a> : <a href="#sign_54">sign</a>
    }

  <span class="keyword">predicate</span> <a name="is_constraint_73">is_constraint</a> (con: <a href="#constraint_67">constraint</a>) = Array.<a href="array.html#length_17">length</a> con.<a href="#a_68">a</a> = <a href="#n_45">n</a>

  <span class="keyword">function</span> <a name="dot_75">dot</a> (a b: <a href="array.html#array_15">array</a> real) : real =
    <a href="#sum_6">sum</a> (<span class="keyword">fun</span> i -&gt; a[i] <a href="real.html#infix%20*._71">*.</a> b[i]) 0 <a href="#n_45">n</a>

  <span class="keyword">predicate</span> <a name="sat_constraint_78">sat_constraint</a> (sol: <a href="array.html#array_15">array</a> real) (con: <a href="#constraint_67">constraint</a>) =
    <span class="keyword">match</span> con.<a href="#s_70">s</a> <span class="keyword">with</span>
    | <a href="#Leq_55">Leq</a> -&gt; <a href="#dot_75">dot</a> con.<a href="#a_68">a</a> sol <a href="real.html#infix%20%3C=_24">&lt;=</a> con.<a href="#b_69">b</a>
    | <a href="#Geq_56">Geq</a> -&gt; <a href="#dot_75">dot</a> con.<a href="#a_68">a</a> sol <a href="real.html#infix%20%3E=_25">&gt;=</a> con.<a href="#b_69">b</a>
    | <a href="#Eq_57">Eq</a> -&gt; <a href="#dot_75">dot</a> con.<a href="#a_68">a</a> sol = con.<a href="#b_69">b</a>
    <span class="keyword">end</span>

  <span class="keyword">type</span> <a name="objective_sense_85">objective_sense</a> =
    | <a name="Min_86">Min</a>
    | <a name="Max_87">Max</a>

  <span class="keyword">type</span> <a name="objective_function_89">objective_function</a> = {
    <a name="c_90">c</a> : <a href="array.html#array_15">array</a> real;
    <a name="sense_91">sense</a> : <a href="#objective_sense_85">objective_sense</a>;
    }

  <span class="keyword">predicate</span> <a name="is_objective_function_94">is_objective_function</a> (obj_func: <a href="#objective_function_89">objective_function</a>) = Array.<a href="array.html#length_17">length</a> obj_func.<a href="#c_90">c</a> = <a href="#n_45">n</a>

  <span class="keyword">type</span> <a name="lower_bound_96">lower_bound</a> =
    | <a name="LNone_97">LNone</a>
    | <a name="LNum_98">LNum</a> real

  <span class="keyword">type</span> <a name="upper_bound_100">upper_bound</a> =
    | <a name="UNone_101">UNone</a>
    | <a name="UNum_102">UNum</a> real

  <span class="keyword">type</span> <a name="interval_104">interval</a> = {
    <a name="lb_105">lb</a>: <a href="#lower_bound_96">lower_bound</a>;
    <a name="ub_106">ub</a>: <a href="#upper_bound_100">upper_bound</a>
    }

  <span class="keyword">type</span> <a name="rtp_type_109">rtp_type</a> =
    | <a name="Infeasible_110">Infeasible</a>
    | <a name="Interval_111">Interval</a> <a href="#interval_104">interval</a>

  <span class="keyword">type</span> <a name="reason_114">reason</a> =
    | <a name="Asm_115">Asm</a>
    | <a name="Lin_116">Lin</a>
    | <a name="Rnd_117">Rnd</a>
    | <a name="Uns_118">Uns</a>
    | <a name="Sol_119">Sol</a>

  <span class="keyword">type</span> <a name="reason_data_121">reason_data</a> =
    | <a name="D_none_122">D_none</a>                      <span class="comment">(* for Asm and Sol *)</span>
    | <a name="D_lin_comb_123">D_lin_comb</a> (<a href="array.html#array_15">array</a> real)      <span class="comment">(* for Lin and Rnd: dense array of length d *)</span>
    | <a name="D_uns_124">D_uns</a> (<a href="array.html#array_15">array</a> int)            <span class="comment">(* for Uns: array of 4 indices in [0, d) *)</span>

  <span class="keyword">predicate</span> <a name="in_range_127">in_range</a> (x:int) (ub:int) =
    Int. (<a href="int.html#infix%20%3C=_25">&lt;=</a>) 0 x /\  Int. (<a href="int.html#infix%20%3C_21">&lt;</a>) x ub

  <span class="keyword">predicate</span> <a name="valid_reason_data_130">valid_reason_data</a> (r: <a href="#reason_114">reason</a>) (rd: <a href="#reason_data_121">reason_data</a>) =
    ((r = <a href="#Asm_115">Asm</a> \/ r = <a href="#Sol_119">Sol</a>) /\ rd = <a href="#D_none_122">D_none</a>) \/
    ((r = <a href="#Lin_116">Lin</a> \/ r = <a href="#Rnd_117">Rnd</a>) /\ (<span class="keyword">exists</span> arr. rd = <a href="#D_lin_comb_123">D_lin_comb</a> arr /\ Array.<a href="array.html#length_17">length</a> arr = <a href="#d_47">d</a>))
    \/ (r = <a href="#Uns_118">Uns</a> /\ (<span class="keyword">exists</span> arr. rd = <a href="#D_uns_124">D_uns</a> arr /\ Array.<a href="array.html#length_17">length</a> arr = 4
    /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i 4 -&gt; <a href="#in_range_127">in_range</a> arr[i] <a href="#d_47">d</a> )))

  <span class="keyword">type</span> <a name="derived_constraint_137">derived_constraint</a> = {
    <a name="con_138">con</a>: <a href="#constraint_67">constraint</a>;
    <a name="rsn_139">rsn</a>: <a href="#reason_114">reason</a>;
    <a name="data_140">data</a>: <a href="#reason_data_121">reason_data</a>;
    <a name="a_set_141">a_set</a>: <a href="set.html#set_27">set</a> int; <span class="comment">(*assumption set*)</span>
    }

  <span class="keyword">predicate</span> <a name="is_der_con_144">is_der_con</a> (dc: <a href="#derived_constraint_137">derived_constraint</a>) =
    <a href="#is_constraint_73">is_constraint</a> dc.<a href="#con_138">con</a> /\ <a href="#valid_reason_data_130">valid_reason_data</a> dc.<a href="#rsn_139">rsn</a> dc.<a href="#data_140">data</a> /\
    <span class="keyword">forall</span> i: int. <a href="set.html#mem_33">mem</a> i dc.<a href="#a_set_141">a_set</a> -&gt; (Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i <a href="#d_47">d</a>)

  <span class="keyword">lemma</span> <a name="valid_reason_data_Asm'lemma_149">valid_reason_data_Asm</a>:
    <a href="#valid_reason_data_130">valid_reason_data</a> <a href="#Asm_115">Asm</a> <a href="#D_none_122">D_none</a>

  <span class="keyword">lemma</span> <a name="valid_reason_data_does_imply_data_none'lemma_152">valid_reason_data_does_imply_data_none</a>:
  <span class="keyword">forall</span> rsn: <a href="#reason_114">reason</a>, dat: <a href="#reason_data_121">reason_data</a>.
    <a href="#valid_reason_data_130">valid_reason_data</a> rsn dat -&gt; rsn = <a href="#Asm_115">Asm</a> -&gt; dat = <a href="#D_none_122">D_none</a>

   <span class="comment">(*helper can be ignored*)</span>
  <span class="keyword">function</span> <a name="index_from_der_index_157">index_from_der_index</a> (der_i: int) : int = Int.(<a href="int.html#infix%20+_19">+</a>) der_i <a href="#m_46">m</a>

  <span class="keyword">type</span> <a name="certificate_159">certificate</a> = {
    <a name="cINT_160">cINT</a>: <a href="set.html#set_27">set</a> int;
    <a name="cOBJ_161">cOBJ</a>: <a href="#objective_function_89">objective_function</a>;
    <a name="cCON_162">cCON</a>: <a href="array.html#array_15">array</a> <a href="#constraint_67">constraint</a>;
    <a name="cRTP_163">cRTP</a>: <a href="#rtp_type_109">rtp_type</a>;
    <a name="cSOL_164">cSOL</a>: <a href="set.html#set_27">set</a> (<a href="array.html#array_15">array</a> real); <span class="comment">(* check that each array has length n below *)</span>
    <a name="cDER_165">cDER</a>: <a href="array.html#array_15">array</a> <a href="#derived_constraint_137">derived_constraint</a>;
    }

  <span class="keyword">predicate</span> <a name="is_asm_index_168">is_asm_index</a> (cert: <a href="#certificate_159">certificate</a>) (i: int) =
    Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i <a href="#d_47">d</a> /\
    <span class="keyword">let</span> j = Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a> <span class="keyword">in</span>
    <a href="#in_range_127">in_range</a> j (<a href="array.html#length_17">length</a> cert.<a href="#cDER_165">cDER</a>) /\
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[j] <span class="keyword">in</span>
    dc.<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a>

  <span class="comment">(* check all dimensions and all other requirements *)</span>
  <span class="keyword">predicate</span> <a name="is_cert_176">is_cert</a> (cert: <a href="#certificate_159">certificate</a>) =
    (<span class="keyword">forall</span> i: int. <a href="set.html#mem_33">mem</a> i cert.<a href="#cINT_160">cINT</a> -&gt; <a href="#in_range_127">in_range</a> i <a href="#n_45">n</a>) /\
    (<a href="#is_objective_function_94">is_objective_function</a> cert.<a href="#cOBJ_161">cOBJ</a>) /\
    (<a href="array.html#length_17">length</a> cert.<a href="#cCON_162">cCON</a> = <a href="#m_46">m</a>) /\ (<span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#m_46">m</a> -&gt; <a href="#is_constraint_73">is_constraint</a> cert.<a href="#cCON_162">cCON</a>[i]) /\
    (<span class="keyword">forall</span> sol: (<a href="array.html#array_15">array</a> real). <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> -&gt; <a href="array.html#length_17">length</a> sol = <a href="#n_45">n</a>) /\
    <span class="comment">(* derived constraint predicates *)</span>
    (<a href="array.html#length_17">length</a> cert.<a href="#cDER_165">cDER</a> = Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>) /\ <span class="comment">(* length of DER is d-m *)</span>
    (<span class="keyword">forall</span> idx: int. <a href="#in_range_127">in_range</a> idx (<a href="array.html#length_17">length</a> cert.<a href="#cDER_165">cDER</a>) -&gt; <a href="#is_der_con_144">is_der_con</a> cert.<a href="#cDER_165">cDER</a>[idx]) /\ <span class="comment">(* each one is a derived constraint *)</span>
    (<span class="keyword">forall</span> idx: int. <a href="#in_range_127">in_range</a> idx (<a href="array.html#length_17">length</a> cert.<a href="#cDER_165">cDER</a>) -&gt;
      <span class="keyword">forall</span> i: int. <a href="set.html#mem_33">mem</a> i cert.<a href="#cDER_165">cDER</a>[idx].<a href="#a_set_141">a_set</a> -&gt; <a href="#is_asm_index_168">is_asm_index</a> cert i /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) (Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>) idx) <span class="comment">(* all assumptions of each one are assumptions and have smaller index *)</span>

   <span class="comment">(*helper can be ignored*)</span>
   <span class="keyword">predicate</span> <a name="test_lt_189">test_lt</a> (cert: <a href="#certificate_159">certificate</a>) =
     <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#m_46">m</a> -&gt; <a href="#is_constraint_73">is_constraint</a> cert.<a href="#cCON_162">cCON</a>[i]

<span class="keyword">end</span>

<span class="keyword">theory</span> <a name="VIPRHelpers_">VIPRHelpers</a>

  <span class="keyword">use</span> <a href="#VIPRCertificate_">VIPRCertificate</a>
  <span class="keyword">use</span> int.<a href="int.html#Int_">Int</a>
  <span class="keyword">use</span> int.<a href="int.html#Lex2_">Lex2</a>
  <span class="keyword">use</span> real.<a href="real.html#Real_">Real</a>
  <span class="keyword">use</span> real.<a href="real.html#RealInfix_">RealInfix</a>
  <span class="keyword">use</span> real.<a href="real.html#FromInt_">FromInt</a>
  <span class="keyword">use</span> real.<a href="real.html#Truncate_">Truncate</a>
  <span class="keyword">use</span> array.<a href="array.html#Array_">Array</a>
  <span class="keyword">use</span> array.<a href="array.html#ArrayEq_">ArrayEq</a>
  <span class="keyword">use</span> set.<a href="set.html#Set_">Set</a>
  <span class="keyword">use</span> <a href="#Sum_">Sum</a>
  <span class="keyword">use</span> <a href="#Init_">Init</a>

  <span class="comment">(* Defining generalied versions of signs and constraints for linear combination constraints *)</span>
  <span class="keyword">type</span> <a name="generalized_sign_212">generalized_sign</a> =
    | <a name="Sign_213">Sign</a> <a href="#sign_54">sign</a>
    | <a name="SNone_214">SNone</a>
  <span class="keyword">type</span> <a name="generalized_constraint_215">generalized_constraint</a> = {
    <a name="lhs_216">lhs</a>: <a href="array.html#array_15">array</a> real;
    <a name="rhs_217">rhs</a>: real;
    <a name="sgn_218">sgn</a>: <a href="#generalized_sign_212">generalized_sign</a>
    }
  <span class="keyword">function</span> <a name="get_constraint_220">get_constraint</a> (cert: <a href="#certificate_159">certificate</a>) (k: int) : <a href="#constraint_67">constraint</a> =
    <span class="keyword">if</span> Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) k <a href="#m_46">m</a> <span class="keyword">then</span> cert.<a href="#cCON_162">cCON</a>[k] <span class="keyword">else</span> cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) k <a href="#m_46">m</a>].<a href="#con_138">con</a>

  <span class="keyword">predicate</span> <a name="is_absurdity_223">is_absurdity</a> (con: <a href="#constraint_67">constraint</a>) =
    (<span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#n_45">n</a> -&gt; con.<a href="#a_68">a</a>[i] = 0.0) /\
    <span class="keyword">match</span> con.<a href="#s_70">s</a> <span class="keyword">with</span>
    | <a href="#Geq_56">Geq</a> -&gt;  con.<a href="#b_69">b</a> <a href="real.html#infix%20%3E_23">&gt;</a> 0.0
    | <a href="#Leq_55">Leq</a> -&gt;  con.<a href="#b_69">b</a> <a href="real.html#infix%20%3C_21">&lt;</a> 0.0
    | <a href="#Eq_57">Eq</a> -&gt; con.<a href="#b_69">b</a> &lt;&gt; 0.0
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="con_dom_con_232">con_dom_con</a> (c1: <a href="#constraint_67">constraint</a>) (c2: <a href="#constraint_67">constraint</a>) =
    <a href="#is_absurdity_223">is_absurdity</a> c1 \/
     (
     (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; c1.<a href="#a_68">a</a>[j] = c2.<a href="#a_68">a</a>[j]) /\
     ((c1.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\ c2.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> /\ c1.<a href="#b_69">b</a> <a href="real.html#infix%20%3E=_25">&gt;=</a> c2.<a href="#b_69">b</a>) \/
     (c1.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\ c2.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>  /\ c1.<a href="#b_69">b</a> = c2.<a href="#b_69">b</a>) \/
     (c1.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\ c2.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> /\ c1.<a href="#b_69">b</a> <a href="real.html#infix%20%3C=_24">&lt;=</a> c2.<a href="#b_69">b</a>) \/
     (c1.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> /\ c2.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> /\ c1.<a href="#b_69">b</a> <a href="real.html#infix%20%3E=_25">&gt;=</a> c2.<a href="#b_69">b</a>) \/
     (c1.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> /\ c2.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> /\ c1.<a href="#b_69">b</a> <a href="real.html#infix%20%3C=_24">&lt;=</a> c2.<a href="#b_69">b</a>))
     )

  <span class="keyword">predicate</span> <a name="gen_con_dom_con_244">gen_con_dom_con</a> (c1: <a href="#generalized_constraint_215">generalized_constraint</a>) (c2: <a href="#constraint_67">constraint</a>) =
    <span class="keyword">match</span> c1.<a href="#sgn_218">sgn</a> <span class="keyword">with</span>
    | <a href="#SNone_214">SNone</a> -&gt; <span class="keyword">false</span>
    | <a href="#Sign_213">Sign</a> sign -&gt; <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = c1.<a href="#lhs_216">lhs</a>; <a href="#b_69">b</a> = c1.<a href="#rhs_217">rhs</a>; <a href="#s_70">s</a> = sign } c2
    <span class="keyword">end</span>

  <span class="comment">(* helper can be ignored *)</span>
  <span class="keyword">predicate</span> <a name="is_gen_con_test_251">is_gen_con_test</a> (gc: <a href="#generalized_constraint_215">generalized_constraint</a>) = Array.<a href="array.html#length_17">length</a> gc.<a href="#lhs_216">lhs</a> = <a href="#n_45">n</a>

  <span class="keyword">function</span> <a name="get_lin_comb_254">get_lin_comb</a> <span class="comment">(*Below: length weights = d *)</span>
    (cert: <a href="#certificate_159">certificate</a>) (weights: <a href="array.html#array_15">array</a> real) : <a href="#generalized_constraint_215">generalized_constraint</a> =
    {
      <a href="#lhs_216">lhs</a> = <a href="#init_19">init</a> <a href="#n_45">n</a> (<span class="keyword">fun</span> j -&gt; (<a href="#sum_6">sum</a> (<span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#a_68">a</a>[j]) 0 <a href="#d_47">d</a>));
      <a href="#rhs_217">rhs</a> = <a href="#sum_6">sum</a> (<span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#b_69">b</a>) 0 <a href="#d_47">d</a>;
      <a href="#sgn_218">sgn</a> =
        <span class="keyword">let</span> sgn_prod =
          <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>))
        <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=_25">&gt;=</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> some_pos   : bool = <span class="keyword">exists</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ sgn_prod i <a href="real.html#infix%20%3E_23">&gt;</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=_24">&lt;=</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> some_neg   : bool = <span class="keyword">exists</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ sgn_prod i <a href="real.html#infix%20%3C_21">&lt;</a> 0.0 <span class="keyword">in</span>
          <span class="keyword">if</span> all_nonneg /\ some_pos <span class="keyword">then</span> <a href="#Sign_213">Sign</a> <a href="#Geq_56">Geq</a>
          <span class="keyword">else</span> <span class="keyword">if</span> all_zero <span class="keyword">then</span> <a href="#Sign_213">Sign</a> <a href="#Eq_57">Eq</a>
          <span class="keyword">else</span> <span class="keyword">if</span> all_nonpos /\ some_neg <span class="keyword">then</span> <a href="#Sign_213">Sign</a> <a href="#Leq_55">Leq</a>
          <span class="keyword">else</span> <a href="#SNone_214">SNone</a>
    }

  <span class="comment">(* Rnd versions of above *)</span>
  <span class="keyword">predicate</span> <a name="roundable_276">roundable</a> (cert: <a href="#certificate_159">certificate</a>) (con: <a href="#constraint_67">constraint</a>) =
    con.<a href="#s_70">s</a> &lt;&gt; <a href="#Eq_57">Eq</a> /\
    <span class="keyword">forall</span> i. <a href="#in_range_127">in_range</a> i <a href="#n_45">n</a> -&gt;
      <span class="keyword">if</span> <a href="set.html#mem_33">mem</a> i cert.<a href="#cINT_160">cINT</a> <span class="keyword">then</span> <a href="#is_integer_39">is_integer</a> con.<a href="#a_68">a</a>[i] <span class="keyword">else</span> con.<a href="#a_68">a</a>[i] = 0.0

  <span class="keyword">function</span> <a name="rnd_281">rnd</a> (cert: <a href="#certificate_159">certificate</a>) (con: <a href="#constraint_67">constraint</a>) : <a href="#constraint_67">constraint</a> =
    <span class="keyword">if</span> <span class="keyword">not</span> <a href="#roundable_276">roundable</a> cert con <span class="keyword">then</span> con <span class="keyword">else</span>
      <span class="keyword">match</span> con.<a href="#s_70">s</a> <span class="keyword">with</span>
      | <a href="#Geq_56">Geq</a> -&gt; { <a href="#a_68">a</a> = con.<a href="#a_68">a</a>; <a href="#b_69">b</a> = (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> con.<a href="#b_69">b</a>)); <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> }
      | <a href="#Leq_55">Leq</a> -&gt; { <a href="#a_68">a</a> = con.<a href="#a_68">a</a>; <a href="#b_69">b</a> = (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> con.<a href="#b_69">b</a>)); <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> }
      | <a href="#Eq_57">Eq</a> -&gt; con
      <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="rnd_con_dom_con_289">rnd_con_dom_con</a> (cert: <a href="#certificate_159">certificate</a>) (c1: <a href="#constraint_67">constraint</a>) (c2: <a href="#constraint_67">constraint</a>) =
    <span class="keyword">if</span> <a href="#roundable_276">roundable</a> cert c1 <span class="keyword">then</span> <a href="#con_dom_con_232">con_dom_con</a> (<a href="#rnd_281">rnd</a> cert c1) c2 <span class="keyword">else</span> <span class="keyword">false</span>

  <span class="keyword">predicate</span> <a name="rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> (cert: <a href="#certificate_159">certificate</a>) (c1: <a href="#generalized_constraint_215">generalized_constraint</a>) (c2: <a href="#constraint_67">constraint</a>) =
    <span class="keyword">match</span> c1.<a href="#sgn_218">sgn</a> <span class="keyword">with</span>
    | <a href="#SNone_214">SNone</a> -&gt; <span class="keyword">false</span>
    | <a href="#Sign_213">Sign</a> sign -&gt; <a href="#rnd_con_dom_con_289">rnd_con_dom_con</a> cert { <a href="#a_68">a</a> = c1.<a href="#lhs_216">lhs</a>; <a href="#b_69">b</a> = c1.<a href="#rhs_217">rhs</a>; <a href="#s_70">s</a> = sign } c2
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="is_disjunction_298">is_disjunction</a> (cert: <a href="#certificate_159">certificate</a>) (c1: <a href="#constraint_67">constraint</a>) (c2: <a href="#constraint_67">constraint</a>) =
    (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k <a href="#n_45">n</a> -&gt; c1.<a href="#a_68">a</a>[k] = c2.<a href="#a_68">a</a>[k]) /\ (<span class="keyword">forall</span> i. <a href="#in_range_127">in_range</a> i <a href="#n_45">n</a> -&gt;
    <span class="keyword">if</span> <a href="set.html#mem_33">mem</a> i cert.<a href="#cINT_160">cINT</a> <span class="keyword">then</span> <a href="#is_integer_39">is_integer</a> c1.<a href="#a_68">a</a>[i] <span class="keyword">else</span> c1.<a href="#a_68">a</a>[i] = 0.0) /\
    (<a href="#is_integer_39">is_integer</a> c1.<a href="#b_69">b</a> /\ <a href="#is_integer_39">is_integer</a> c2.<a href="#b_69">b</a>) /\
      <span class="keyword">match</span> c1.<a href="#s_70">s</a>, c2.<a href="#s_70">s</a> <span class="keyword">with</span>
      | <a href="#Geq_56">Geq</a>, <a href="#Leq_55">Leq</a> -&gt; c1.<a href="#b_69">b</a> <a href="algebra.html#infix%20-_156">-</a> c2.<a href="#b_69">b</a> = 1.0
      | <a href="#Leq_55">Leq</a>, <a href="#Geq_56">Geq</a> -&gt; c2.<a href="#b_69">b</a> <a href="algebra.html#infix%20-_156">-</a> c1.<a href="#b_69">b</a> = 1.0
      | _, _ -&gt; <span class="keyword">false</span>
      <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="is_asm_of_308">is_asm_of</a> (cert: <a href="#certificate_159">certificate</a>) (j i: int) = <span class="comment">(* is j in A(C_i) *)</span>
    <span class="keyword">if</span> <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ <span class="keyword">not</span> (<a href="#in_range_127">in_range</a> i <a href="#m_46">m</a>) <span class="keyword">then</span> <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a> <span class="keyword">else</span> <span class="keyword">false</span>

<span class="keyword">end</span>

<span class="keyword">theory</span> <a name="VIPRValidity_">VIPRValidity</a>

  <span class="keyword">use</span> <a href="#VIPRCertificate_">VIPRCertificate</a>
  <span class="keyword">use</span> <a href="#VIPRHelpers_">VIPRHelpers</a>
  <span class="keyword">use</span> int.<a href="int.html#Int_">Int</a>
  <span class="keyword">use</span> int.<a href="int.html#Lex2_">Lex2</a>
  <span class="keyword">use</span> real.<a href="real.html#Real_">Real</a>
  <span class="keyword">use</span> real.<a href="real.html#RealInfix_">RealInfix</a>
  <span class="keyword">use</span> real.<a href="real.html#FromInt_">FromInt</a>
  <span class="keyword">use</span> array.<a href="array.html#Array_">Array</a>
  <span class="keyword">use</span> set.<a href="set.html#Set_">Set</a>

  <span class="keyword">predicate</span> <a name="valid_FEAS_325">valid_FEAS</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">forall</span> sol: (<a href="array.html#array_15">array</a> real). <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> -&gt;
      (<span class="keyword">forall</span> j: int. <a href="set.html#mem_33">mem</a> j cert.<a href="#cINT_160">cINT</a> -&gt; <a href="#is_integer_39">is_integer</a> sol[j]) /\
      (<span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#m_46">m</a> -&gt; <a href="#sat_constraint_78">sat_constraint</a> sol cert.<a href="#cCON_162">cCON</a>[i])

  <span class="keyword">predicate</span> <a name="valid_SOL_330">valid_SOL</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">match</span> cert.<a href="#cRTP_163">cRTP</a> <span class="keyword">with</span>
    | <a href="#Infeasible_110">Infeasible</a> -&gt; <a href="set.html#is_empty_51">is_empty</a> cert.<a href="#cSOL_164">cSOL</a>
    | <a href="#Interval_111">Interval</a> interval -&gt; <a href="#valid_FEAS_325">valid_FEAS</a> cert /\
      <span class="keyword">match</span> interval.<a href="#ub_106">ub</a> <span class="keyword">with</span>
      | <a href="#UNone_101">UNone</a> -&gt; <span class="keyword">true</span>
      | <a href="#UNum_102">UNum</a> upper -&gt; (cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Min_86">Min</a> -&gt;
        <span class="keyword">exists</span> x: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> x cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#sat_constraint_78">sat_constraint</a> x { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = upper; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> })
      <span class="keyword">end</span> /\
      <span class="keyword">match</span> interval.<a href="#lb_105">lb</a> <span class="keyword">with</span>
      | <a href="#LNone_97">LNone</a> -&gt; <span class="keyword">true</span>
      | <a href="#LNum_98">LNum</a> lower -&gt; (cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Max_87">Max</a> -&gt;
        <span class="keyword">exists</span> x: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> x cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#sat_constraint_78">sat_constraint</a> x { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = lower; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> })
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="comment">(* all validity assumptions here *)</span>
  <span class="keyword">predicate</span> <a name="val_ASM_348">val_ASM</a> (cert: <a href="#certificate_159">certificate</a>) (k: int) =
    <span class="keyword">let</span> k_total = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">match</span> dc.<a href="#rsn_139">rsn</a>, dc.<a href="#data_140">data</a> <span class="keyword">with</span>
    | <a href="#Asm_115">Asm</a>, <a href="#D_none_122">D_none</a> -&gt; dc.<a href="#a_set_141">a_set</a> = <a href="set.html#add_64">add</a> (Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a>) <a href="set.html#empty_53">empty</a>

    | <a href="#Lin_116">Lin</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights | <a href="#Rnd_117">Rnd</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights -&gt;  ( (<span class="keyword">forall</span> j:int. <a href="set.html#mem_33">mem</a> j dc.<a href="#a_set_141">a_set</a> &lt;-&gt; <span class="keyword">exists</span> i:int.
         weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i k_total /\ <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a>) /\
       (<span class="keyword">forall</span> i:int. weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i k_total -&gt;
        <span class="keyword">forall</span> j:int. <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a> -&gt; <a href="set.html#mem_33">mem</a> j dc.<a href="#a_set_141">a_set</a>) )   <span class="comment">(*asumption set of derived constraints is exactly the union of inherited assumptions*)</span>

    | <a href="#Uns_118">Uns</a>, <a href="#D_uns_124">D_uns</a> indices -&gt;
       <span class="keyword">let</span> i1 = indices[0] <span class="keyword">in</span>
        <span class="keyword">let</span> l1 = indices[1] <span class="keyword">in</span>
        <span class="keyword">let</span> i2 = indices[2] <span class="keyword">in</span>
        <span class="keyword">let</span> l2 = indices[3] <span class="keyword">in</span>
       <span class="keyword">forall</span> j: int.
          <a href="#is_asm_of_308">is_asm_of</a> cert j k_total &lt;-&gt; (
            (<a href="#is_asm_of_308">is_asm_of</a> cert j i1 /\ j &lt;&gt; l1) \/
            (<a href="#is_asm_of_308">is_asm_of</a> cert j i2 /\ j &lt;&gt; l2)
          )
    | <a href="#Sol_119">Sol</a>, <a href="#D_none_122">D_none</a> -&gt; <a href="set.html#is_empty_51">is_empty</a> dc.<a href="#a_set_141">a_set</a>
    | _, _ -&gt; <span class="keyword">false</span>
    <span class="keyword">end</span>

   <span class="keyword">predicate</span> <a name="valid_DER_k_373">valid_DER_k</a> (cert: <a href="#certificate_159">certificate</a>) (k: int) =
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <a href="#val_ASM_348">val_ASM</a> cert k /\
    <span class="keyword">match</span> dc.<a href="#rsn_139">rsn</a>, dc.<a href="#data_140">data</a> <span class="keyword">with</span>
    | <a href="#Asm_115">Asm</a>, <a href="#D_none_122">D_none</a> -&gt; <span class="keyword">true</span>
    | <a href="#Lin_116">Lin</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights -&gt;
         (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (<a href="#gen_con_dom_con_244">gen_con_dom_con</a> (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)

     | <a href="#Rnd_117">Rnd</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights -&gt;
        (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)

    | <a href="#Uns_118">Uns</a>, <a href="#D_uns_124">D_uns</a> indices -&gt;
        <span class="keyword">let</span> i1 = indices[0] <span class="keyword">in</span>
        <span class="keyword">let</span> l1 = indices[1] <span class="keyword">in</span>
        <span class="keyword">let</span> i2 = indices[2] <span class="keyword">in</span>
        <span class="keyword">let</span> l2 = indices[3] <span class="keyword">in</span>
        <a href="#in_range_127">in_range</a> i1 total_k /\ <a href="#in_range_127">in_range</a> l1 total_k /\ <a href="#in_range_127">in_range</a> i2 total_k /\ <a href="#in_range_127">in_range</a> l2 total_k /\
        <span class="keyword">let</span> ci1 = <a href="#get_constraint_220">get_constraint</a> cert i1 <span class="keyword">in</span>
        <span class="keyword">let</span> cl1 = <a href="#get_constraint_220">get_constraint</a> cert l1 <span class="keyword">in</span>
        <span class="keyword">let</span> ci2 = <a href="#get_constraint_220">get_constraint</a> cert i2 <span class="keyword">in</span>
        <span class="keyword">let</span> cl2 = <a href="#get_constraint_220">get_constraint</a> cert l2 <span class="keyword">in</span>
        <a href="#con_dom_con_232">con_dom_con</a> ci1 dc.<a href="#con_138">con</a> /\
        <a href="#con_dom_con_232">con_dom_con</a> ci2 dc.<a href="#con_138">con</a> /\
        <a href="#is_disjunction_298">is_disjunction</a> cert cl1 cl2

    | <a href="#Sol_119">Sol</a>, <a href="#D_none_122">D_none</a> -&gt;
         ((cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Min_86">Min</a> -&gt; <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\
         <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } dc.<a href="#con_138">con</a>) /\ (cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Max_87">Max</a> -&gt;
         <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\
         <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } dc.<a href="#con_138">con</a>))

    | _, _ -&gt; <span class="keyword">false</span>
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="valid_DER_410">valid_DER</a> (cert: <a href="#certificate_159">certificate</a>) =
    (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k (Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>) -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k) /\
    <span class="keyword">let</span> d_index = Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> 1 <span class="keyword">in</span>
    <span class="keyword">let</span> cd = <a href="#get_constraint_220">get_constraint</a> cert d_index
    <span class="keyword">in</span>
    <span class="keyword">match</span> cert.<a href="#cRTP_163">cRTP</a>, cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> <span class="keyword">with</span>
    | <a href="#Infeasible_110">Infeasible</a>, _ -&gt; (<span class="keyword">forall</span> j: int. <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j d_index) /\ <a href="#is_absurdity_223">is_absurdity</a> cd
    | <a href="#Interval_111">Interval</a> interval, <a href="#Min_86">Min</a> -&gt;
      <span class="keyword">match</span> interval.<a href="#lb_105">lb</a> <span class="keyword">with</span>
      | <a href="#LNone_97">LNone</a> -&gt; <span class="keyword">true</span>
      | <a href="#LNum_98">LNum</a> lower -&gt; <a href="#con_dom_con_232">con_dom_con</a> cd { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = lower; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } /\
         <span class="keyword">forall</span> j: int. <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j d_index
      <span class="keyword">end</span>
    | <a href="#Interval_111">Interval</a> interval, <a href="#Max_87">Max</a> -&gt;
      <span class="keyword">match</span> interval.<a href="#ub_106">ub</a> <span class="keyword">with</span>
      | <a href="#UNone_101">UNone</a> -&gt; <span class="keyword">true</span>
      | <a href="#UNum_102">UNum</a> upper -&gt; <a href="#con_dom_con_232">con_dom_con</a> cd { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = upper; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } /\
         <span class="keyword">forall</span> j: int. <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j d_index
      <span class="keyword">end</span>
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="valid_431">valid</a> (cert: <a href="#certificate_159">certificate</a>) = <a href="#valid_SOL_330">valid_SOL</a> cert /\ <a href="#valid_DER_410">valid_DER</a> cert

<span class="keyword">end</span>

<span class="keyword">theory</span> <a name="VIPRPredicate_">VIPRPredicate</a>

  <span class="keyword">use</span> <a href="#VIPRCertificate_">VIPRCertificate</a>
  <span class="keyword">use</span> <a href="#VIPRHelpers_">VIPRHelpers</a>
  <span class="keyword">use</span> int.<a href="int.html#Int_">Int</a>
  <span class="keyword">use</span> int.<a href="int.html#Lex2_">Lex2</a>
  <span class="keyword">use</span> real.<a href="real.html#Real_">Real</a>
  <span class="keyword">use</span> real.<a href="real.html#RealInfix_">RealInfix</a>
  <span class="keyword">use</span> real.<a href="real.html#FromInt_">FromInt</a>
  <span class="keyword">use</span> real.<a href="real.html#Truncate_">Truncate</a>
  <span class="keyword">use</span> array.<a href="array.html#Array_">Array</a>
  <span class="keyword">use</span> set.<a href="set.html#Set_">Set</a>
  <span class="keyword">use</span> <a href="#Sum_">Sum</a>
  <span class="keyword">use</span> <a href="#Init_">Init</a>

  <span class="keyword">predicate</span> <a name="p_451">p</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">match</span> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> <span class="keyword">with</span>
    | <a href="#Min_86">Min</a> -&gt; <span class="keyword">true</span>
    | <a href="#Max_87">Max</a> -&gt; <span class="keyword">false</span>
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="r_457">r</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">match</span> cert.<a href="#cRTP_163">cRTP</a> <span class="keyword">with</span>
    | <a href="#Infeasible_110">Infeasible</a> -&gt; <span class="keyword">false</span>
    | <a href="#Interval_111">Interval</a> _ -&gt; <span class="keyword">true</span>
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="pub_463">pub</a> (cert: <a href="#certificate_159">certificate</a>) =
  (<span class="keyword">exists</span> i: <a href="#interval_104">interval</a>. cert.<a href="#cRTP_163">cRTP</a> = <a href="#Interval_111">Interval</a> i /\
    (<span class="keyword">exists</span> r: real. i.<a href="#ub_106">ub</a> = <a href="#UNum_102">UNum</a> r))

  <span class="keyword">function</span> <a name="u_467">u</a> (cert: <a href="#certificate_159">certificate</a>) : real =
    <span class="keyword">match</span> cert.<a href="#cRTP_163">cRTP</a> <span class="keyword">with</span>
    | <a href="#Interval_111">Interval</a> i -&gt;
      <span class="keyword">match</span> i.<a href="#ub_106">ub</a> <span class="keyword">with</span>
      | <a href="#UNone_101">UNone</a> -&gt; 0.0
      | <a href="#UNum_102">UNum</a> x -&gt; x
      <span class="keyword">end</span>
    | <a href="#Infeasible_110">Infeasible</a> -&gt; 0.0
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="plb_477">plb</a> (cert: <a href="#certificate_159">certificate</a>) =
  (<span class="keyword">exists</span> i: <a href="#interval_104">interval</a>. cert.<a href="#cRTP_163">cRTP</a> = <a href="#Interval_111">Interval</a> i /\
    (<span class="keyword">exists</span> r: real. i.<a href="#lb_105">lb</a> = <a href="#LNum_98">LNum</a> r))

  <span class="keyword">function</span> <a name="l_481">l</a> (cert: <a href="#certificate_159">certificate</a>) : real =
    <span class="keyword">match</span> cert.<a href="#cRTP_163">cRTP</a> <span class="keyword">with</span>
    | <a href="#Interval_111">Interval</a> i -&gt;
      <span class="keyword">match</span> i.<a href="#lb_105">lb</a> <span class="keyword">with</span>
      | <a href="#LNone_97">LNone</a> -&gt; 0.0
      | <a href="#LNum_98">LNum</a> x -&gt; x
      <span class="keyword">end</span>
    | <a href="#Infeasible_110">Infeasible</a> -&gt; 0.0
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="phi_FEAS_491">phi_FEAS</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">forall</span> sol: (<a href="array.html#array_15">array</a> real). <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> -&gt;
      (<span class="keyword">forall</span> j: int. <a href="set.html#mem_33">mem</a> j cert.<a href="#cINT_160">cINT</a> -&gt; <a href="#is_integer_39">is_integer</a> sol[j]) /\
      (<span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#m_46">m</a> -&gt;
        (Int.(<a href="int.html#infix%20%3E=_26">&gt;=</a>) (<a href="#sign_to_int_59">sign_to_int</a> cert.<a href="#cCON_162">cCON</a>[i].<a href="#s_70">s</a>) 0 -&gt; <a href="#dot_75">dot</a> cert.<a href="#cCON_162">cCON</a>[i].<a href="#a_68">a</a> sol <a href="real.html#infix%20%3E=_25">&gt;=</a> cert.<a href="#cCON_162">cCON</a>[i].<a href="#b_69">b</a>) /\
        (Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) (<a href="#sign_to_int_59">sign_to_int</a> cert.<a href="#cCON_162">cCON</a>[i].<a href="#s_70">s</a>) 0 -&gt; <a href="#dot_75">dot</a> cert.<a href="#cCON_162">cCON</a>[i].<a href="#a_68">a</a> sol <a href="real.html#infix%20%3C=_24">&lt;=</a> cert.<a href="#cCON_162">cCON</a>[i].<a href="#b_69">b</a>)
      )

<span class="keyword">predicate</span> <a name="phi_SOL_499">phi_SOL</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">if</span> <span class="keyword">not</span> <a href="#r_457">r</a> cert <span class="keyword">then</span> <a href="set.html#is_empty_51">is_empty</a> cert.<a href="#cSOL_164">cSOL</a> <span class="keyword">else</span>
    (<a href="#phi_FEAS_491">phi_FEAS</a> cert /\ (<span class="keyword">if</span> <a href="#p_451">p</a> cert <span class="keyword">then</span>
    (<a href="#pub_463">pub</a> cert -&gt;
      <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#sat_constraint_78">sat_constraint</a> sol { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#u_467">u</a> cert; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> }
    ) <span class="keyword">else</span>
    (<a href="#plb_477">plb</a> cert -&gt;
      <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#sat_constraint_78">sat_constraint</a> sol { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#l_481">l</a> cert; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> }
    )))

 <span class="keyword">predicate</span> <a name="phi_ASM_509">phi_ASM</a> (cert: <a href="#certificate_159">certificate</a>) (k: int) =
    <span class="keyword">let</span> k_total = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    (<span class="keyword">forall</span> j. ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) j k_total) -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j k_total)) /\
    <span class="keyword">match</span> dc.<a href="#rsn_139">rsn</a>, dc.<a href="#data_140">data</a> <span class="keyword">with</span>
    | <a href="#Asm_115">Asm</a>, <a href="#D_none_122">D_none</a> -&gt; <a href="#is_asm_of_308">is_asm_of</a> cert k_total k_total /\
        <span class="keyword">forall</span> j: int.
          ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j k_total) -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j k_total)
    | <a href="#Lin_116">Lin</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights | <a href="#Rnd_117">Rnd</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights -&gt;  <span class="keyword">forall</span> j: int. ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j k_total) -&gt;
          (<a href="#is_asm_of_308">is_asm_of</a> cert j k_total =
          <span class="keyword">exists</span> i: int.
            ((weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) j i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i k_total) /\ <a href="#is_asm_of_308">is_asm_of</a> cert j i)))
    | <a href="#Uns_118">Uns</a>, <a href="#D_uns_124">D_uns</a> indices -&gt;
        <span class="keyword">let</span> i1 = indices[0] <span class="keyword">in</span>
        <span class="keyword">let</span> l1 = indices[1] <span class="keyword">in</span>
        <span class="keyword">let</span> i2 = indices[2] <span class="keyword">in</span>
        <span class="keyword">let</span> l2 = indices[3] <span class="keyword">in</span>
        <span class="keyword">forall</span> j: int. ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j k_total) -&gt;
          ((<a href="#is_asm_of_308">is_asm_of</a> cert j k_total) = ((<a href="#is_asm_of_308">is_asm_of</a> cert j i1 /\ j &lt;&gt; l1) \/ (<a href="#is_asm_of_308">is_asm_of</a> cert j i2 /\ j &lt;&gt; l2))))
    | <a href="#Sol_119">Sol</a>, <a href="#D_none_122">D_none</a> -&gt;
        <span class="keyword">forall</span> j: int.
          ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j k_total) -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j k_total)
    | _, _ -&gt; <span class="keyword">false</span>
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="phi_DOM_expanded_535">phi_DOM_expanded</a>
  (a1 a2: <a href="array.html#array_15">array</a> real) (b1 b2: real) (eq1 eq2 geq1 geq2 leq1 leq2: bool) =
  (
    (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; a1[j] = 0.0) /\
    (<span class="keyword">if</span> eq1 <span class="keyword">then</span> b1 &lt;&gt; 0.0 <span class="keyword">else</span>
      <span class="keyword">if</span> geq1 <span class="keyword">then</span> b1 <a href="real.html#infix%20%3E_23">&gt;</a> 0.0 <span class="keyword">else</span>
        <span class="keyword">if</span> leq1 <span class="keyword">then</span> b1 <a href="real.html#infix%20%3C_21">&lt;</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
    )
    \/
    (
    (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; a1[j] = a2[j]) /\
    (<span class="keyword">if</span> eq2 <span class="keyword">then</span> eq1 /\ b1 = b2 <span class="keyword">else</span>
      <span class="keyword">if</span> geq2 <span class="keyword">then</span> geq1 /\ b1 <a href="real.html#infix%20%3E=_25">&gt;=</a> b2 <span class="keyword">else</span>
        <span class="keyword">if</span> leq2 <span class="keyword">then</span> leq1 /\ b1 <a href="real.html#infix%20%3C=_24">&lt;=</a> b2 <span class="keyword">else</span> <span class="keyword">false</span>)
    )

  <span class="keyword">predicate</span> <a name="phi_DOM_constr_551">phi_DOM_constr</a> (c1 c2 : <a href="#constraint_67">constraint</a>) =
    <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
      c1.<a href="#a_68">a</a> c2.<a href="#a_68">a</a>
      c1.<a href="#b_69">b</a> c2.<a href="#b_69">b</a>
      (Int.(=) (<a href="#sign_to_int_59">sign_to_int</a> c1.<a href="#s_70">s</a>) 0) (Int.(=) (<a href="#sign_to_int_59">sign_to_int</a> c2.<a href="#s_70">s</a>) 0)
      (Int.(<a href="int.html#infix%20%3E=_26">&gt;=</a>) (<a href="#sign_to_int_59">sign_to_int</a> c1.<a href="#s_70">s</a>) 0) (Int.(<a href="int.html#infix%20%3E=_26">&gt;=</a>) (<a href="#sign_to_int_59">sign_to_int</a> c2.<a href="#s_70">s</a>) 0)
      (Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) (<a href="#sign_to_int_59">sign_to_int</a> c1.<a href="#s_70">s</a>) 0) (Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) (<a href="#sign_to_int_59">sign_to_int</a> c2.<a href="#s_70">s</a>) 0)

  <span class="keyword">predicate</span> <a name="phi_RND_559">phi_RND</a> (cert: <a href="#certificate_159">certificate</a>) (a: <a href="array.html#array_15">array</a> real) (eq: bool) =
    (<span class="keyword">forall</span> j: int. <a href="set.html#mem_33">mem</a> j cert.<a href="#cINT_160">cINT</a> -&gt; <a href="#is_integer_39">is_integer</a> a[j]) /\
    (<span class="keyword">forall</span> j: int. (<a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> /\ <span class="keyword">not</span> <a href="set.html#mem_33">mem</a> j cert.<a href="#cINT_160">cINT</a>) -&gt; a[j] = 0.0) /\
    <span class="keyword">not</span> eq

  <span class="keyword">predicate</span> <a name="phi_DIS_564">phi_DIS</a> (cert: <a href="#certificate_159">certificate</a>) (ci cj: <a href="#constraint_67">constraint</a>) =
    (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k <a href="#n_45">n</a> -&gt; ci.<a href="#a_68">a</a>[k] = cj.<a href="#a_68">a</a>[k]) /\
    (<span class="keyword">forall</span> k: int. <a href="set.html#mem_33">mem</a> k cert.<a href="#cINT_160">cINT</a> -&gt; <a href="#is_integer_39">is_integer</a> ci.<a href="#a_68">a</a>[k]) /\
    (<span class="keyword">forall</span> k: int. (<a href="#in_range_127">in_range</a> k <a href="#n_45">n</a> /\ <span class="keyword">not</span> <a href="set.html#mem_33">mem</a> k cert.<a href="#cINT_160">cINT</a>) -&gt; (ci.<a href="#a_68">a</a>[k] = 0.0)) /\
    (<a href="#is_integer_39">is_integer</a> ci.<a href="#b_69">b</a>) /\ (<a href="#is_integer_39">is_integer</a> cj.<a href="#b_69">b</a>) /\
    (ci.<a href="#s_70">s</a> &lt;&gt; <a href="#Eq_57">Eq</a> /\ cj.<a href="#s_70">s</a> &lt;&gt; <a href="#Eq_57">Eq</a> /\ ci.<a href="#s_70">s</a> &lt;&gt; cj.<a href="#s_70">s</a>) /\
    (<span class="keyword">if</span> ci.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> ci.<a href="#b_69">b</a> = cj.<a href="#b_69">b</a> <a href="real.html#infix%20+_19">+</a> 1.0 <span class="keyword">else</span> ci.<a href="#b_69">b</a> = cj.<a href="#b_69">b</a> <a href="algebra.html#infix%20-_156">-</a> 1.0)

  <span class="keyword">predicate</span> <a name="phi_DER_k_573">phi_DER_k</a> (cert: <a href="#certificate_159">certificate</a>) (k: int) =
    <span class="keyword">let</span> k_total = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <a href="#phi_ASM_509">phi_ASM</a> cert k /\
    <span class="keyword">match</span> dc.<a href="#rsn_139">rsn</a>, dc.<a href="#data_140">data</a> <span class="keyword">with</span>
    | <a href="#Asm_115">Asm</a>, <a href="#D_none_122">D_none</a> -&gt; <span class="keyword">true</span>

    | <a href="#Lin_116">Lin</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights -&gt;
        <span class="keyword">let</span> sgn_prod =
        <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>
        <span class="comment">(* phi_PRV *)</span>
        (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i k_total) /\
        <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a> gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>) all_nonneg (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>) all_nonpos (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>)

    | <a href="#Rnd_117">Rnd</a>, <a href="#D_lin_comb_123">D_lin_comb</a> weights -&gt;
        <span class="keyword">let</span> sgn_prod =
        <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>
        (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i k_total) /\
        <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\ <span class="comment">(* is absurdity *)</span>
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\ <span class="comment">(*domination part*)</span>
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        )
    | <a href="#Uns_118">Uns</a>, <a href="#D_uns_124">D_uns</a> indices -&gt;
        <span class="keyword">let</span> i1 = indices[0] <span class="keyword">in</span>
        <span class="keyword">let</span> l1 = indices[1] <span class="keyword">in</span>
        <span class="keyword">let</span> i2 = indices[2] <span class="keyword">in</span>
        <span class="keyword">let</span> l2 = indices[3] <span class="keyword">in</span>
        (Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) k_total i1) /\ (Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) k_total i2) /\ (Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) k_total l1) /\ (Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) k_total l2) /\
        <span class="keyword">let</span> ci1 = <a href="#get_constraint_220">get_constraint</a> cert i1 <span class="keyword">in</span>
        <span class="keyword">let</span> cl1 = <a href="#get_constraint_220">get_constraint</a> cert l1 <span class="keyword">in</span>
        <span class="keyword">let</span> ci2 = <a href="#get_constraint_220">get_constraint</a> cert i2 <span class="keyword">in</span>
        <span class="keyword">let</span> cl2 = <a href="#get_constraint_220">get_constraint</a> cert l2 <span class="keyword">in</span>
        <a href="#phi_DOM_constr_551">phi_DOM_constr</a> ci1 dc.<a href="#con_138">con</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> ci2 dc.<a href="#con_138">con</a> /\ <a href="#phi_DIS_564">phi_DIS</a> cert cl1 cl2
    | <a href="#Sol_119">Sol</a>, <a href="#D_none_122">D_none</a> -&gt;
        <span class="keyword">if</span> <a href="#p_451">p</a> cert <span class="keyword">then</span>
          <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } dc.<a href="#con_138">con</a>
        <span class="keyword">else</span>
          <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } dc.<a href="#con_138">con</a>
    | _, _ -&gt; <span class="keyword">false</span>
    <span class="keyword">end</span>

  <span class="keyword">predicate</span> <a name="phi_DER_640">phi_DER</a> (cert: <a href="#certificate_159">certificate</a>) =
    <span class="keyword">let</span> d_index = Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> 1 <span class="keyword">in</span>
    <span class="keyword">let</span> cd = <a href="#get_constraint_220">get_constraint</a> cert d_index
    <span class="keyword">in</span>
    (<span class="keyword">forall</span> k: int. (Int. (<a href="int.html#infix%20%3C=_25">&lt;=</a>) 0 k /\ Int. (<a href="int.html#infix%20%3C_21">&lt;</a>) k (Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>)) -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k) /\
    <span class="keyword">if</span> <span class="keyword">not</span> (<a href="#r_457">r</a> cert) <span class="keyword">then</span> (<a href="#phi_DOM_constr_551">phi_DOM_constr</a> cd { <a href="#a_68">a</a> = <a href="array.html#make_52">make</a> <a href="#n_45">n</a> 0.0; <a href="#b_69">b</a> = 1.0; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> }
    /\ (<span class="keyword">forall</span> j:int. <a href="#is_asm_index_168">is_asm_index</a> cert j -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j d_index)) <span class="keyword">else</span>
      (
      (
      (<a href="#p_451">p</a> cert /\ <a href="#plb_477">plb</a> cert) -&gt;
        (
        <a href="#phi_DOM_constr_551">phi_DOM_constr</a> cd { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = (<a href="#l_481">l</a> cert); <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } /\
        (<span class="keyword">forall</span> j:int. <a href="#is_asm_index_168">is_asm_index</a> cert j -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j d_index)
        )
      ) /\
      (
      (<span class="keyword">not</span> <a href="#p_451">p</a> cert /\ <a href="#pub_463">pub</a> cert) -&gt;
        (
        <a href="#phi_DOM_constr_551">phi_DOM_constr</a> cd { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = (<a href="#u_467">u</a> cert); <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } /\
        (<span class="keyword">forall</span> j:int. <a href="#is_asm_index_168">is_asm_index</a> cert j -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j d_index)
        )
      )
      )

  <span class="keyword">predicate</span> <a name="phi_664">phi</a> (cert: <a href="#certificate_159">certificate</a>) = <a href="#phi_SOL_499">phi_SOL</a> cert /\ <a href="#phi_DER_640">phi_DER</a> cert

<span class="keyword">end</span>

<span class="keyword">theory</span> <a name="Main_">Main</a>

  <span class="keyword">use</span> <a href="#VIPRCertificate_">VIPRCertificate</a>
  <span class="keyword">use</span> <a href="#VIPRHelpers_">VIPRHelpers</a>
  <span class="keyword">use</span> <a href="#VIPRValidity_">VIPRValidity</a>
  <span class="keyword">use</span> <a href="#VIPRPredicate_">VIPRPredicate</a>
  <span class="keyword">use</span> array.<a href="array.html#Array_">Array</a>
  <span class="keyword">use</span> set.<a href="set.html#Set_">Set</a>
  <span class="keyword">use</span> array.<a href="array.html#ArrayEq_">ArrayEq</a>
  <span class="keyword">use</span> int.<a href="int.html#Lex2_">Lex2</a>
  <span class="keyword">use</span> real.<a href="real.html#Real_">Real</a>
  <span class="keyword">use</span> real.<a href="real.html#RealInfix_">RealInfix</a>
  <span class="keyword">use</span> real.<a href="real.html#Abs_">Abs</a>
  <span class="keyword">use</span> real.<a href="real.html#FromInt_">FromInt</a>
  <span class="keyword">use</span> real.<a href="real.html#Truncate_">Truncate</a>
  <span class="keyword">use</span> int.<a href="int.html#Lex2_">Lex2</a>
  <span class="keyword">use</span> <a href="#Sum_">Sum</a>
  <span class="keyword">use</span> <a href="#Init_">Init</a>
  <span class="keyword">use</span> int.<a href="int.html#Int_">Int</a>

  <span class="keyword">lemma</span> <a name="LemmaFEAS'lemma_692">LemmaFEAS</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#valid_FEAS_325">valid_FEAS</a> cert &lt;-&gt; <a href="#phi_FEAS_491">phi_FEAS</a> cert)

                               <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="u_matches_ub_when_interval'lemma_697">u_matches_ub_when_interval</a>:
    <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, i: <a href="#interval_104">interval</a>, ub_val: real.
      <span class="keyword">not</span> cert.<a href="#cRTP_163">cRTP</a> = <a href="#Interval_111">Interval</a> i \/ (i.<a href="#ub_106">ub</a> = <a href="#UNum_102">UNum</a> ub_val -&gt;
      <a href="#u_467">u</a> cert = ub_val)

  <span class="keyword">lemma</span> <a name="pub_equiv_unum'lemma_702">pub_equiv_unum</a>:
    <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>.
       <span class="keyword">not</span> <a href="#pub_463">pub</a> cert \/ (<span class="keyword">exists</span> i: <a href="#interval_104">interval</a>.
        cert.<a href="#cRTP_163">cRTP</a> = <a href="#Interval_111">Interval</a> i /\ i.<a href="#ub_106">ub</a> = <a href="#UNum_102">UNum</a> (<a href="#u_467">u</a> cert))

  <span class="keyword">lemma</span> <a name="l_matches_lb_when_interval'lemma_707">l_matches_lb_when_interval</a>:
    <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, i: <a href="#interval_104">interval</a>, lb_val: real.
      <span class="keyword">not</span> cert.<a href="#cRTP_163">cRTP</a> = <a href="#Interval_111">Interval</a> i \/ (i.<a href="#lb_105">lb</a> = <a href="#LNum_98">LNum</a> lb_val -&gt;
      <a href="#l_481">l</a> cert = lb_val)

  <span class="keyword">lemma</span> <a name="plb_equiv_lnum'lemma_712">plb_equiv_lnum</a>:
    <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>.
      <a href="#plb_477">plb</a> cert -&gt;
      <span class="keyword">exists</span> i: <a href="#interval_104">interval</a>.
        cert.<a href="#cRTP_163">cRTP</a> = <a href="#Interval_111">Interval</a> i /\ i.<a href="#lb_105">lb</a> = <a href="#LNum_98">LNum</a> (<a href="#l_481">l</a> cert)

  <span class="keyword">lemma</span> <a name="r_false_iff_infeasible'lemma_718">r_false_iff_infeasible</a>:
    <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>.
      cert.<a href="#cRTP_163">cRTP</a> = <a href="#Infeasible_110">Infeasible</a> -&gt; <span class="keyword">not</span> (<a href="#r_457">r</a> cert)

  <span class="keyword">lemma</span> <a name="LemmaSOL'lemma_724">LemmaSOL</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#valid_SOL_330">valid_SOL</a> cert &lt;-&gt; <a href="#phi_SOL_499">phi_SOL</a> cert)

                                    <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="singleton_membership_characterization'lemma_729">singleton_membership_characterization</a>:
  <span class="keyword">forall</span> s: <a href="set.html#set_27">set</a> int, x: int.
    <a href="set.html#mem_33">mem</a> x s /\
    (<span class="keyword">forall</span> j: int. j &lt;&gt; x -&gt; <span class="keyword">not</span> (<a href="set.html#mem_33">mem</a> j s)) &lt;-&gt;
    s = <a href="set.html#add_64">add</a> x <a href="set.html#empty_53">empty</a>

  <span class="keyword">lemma</span> <a name="singleton_mem_iff'lemma_735">singleton_mem_iff</a>:
  <span class="keyword">forall</span> x y: int. <a href="set.html#mem_33">mem</a> x (<a href="set.html#add_64">add</a> y <a href="set.html#empty_53">empty</a>) &lt;-&gt; x = y

  <span class="keyword">lemma</span> <a name="is_asm_of_singleton'lemma_738">is_asm_of_singleton</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    dc.<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> -&gt; dc.<a href="#a_set_141">a_set</a> = <a href="set.html#add_64">add</a> (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) <a href="set.html#empty_53">empty</a> -&gt;
    <span class="keyword">forall</span> j: int.
      <a href="#is_asm_of_308">is_asm_of</a> cert j (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) &lt;-&gt; j = k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>

  <span class="keyword">lemma</span> <a name="is_asm_index_rsn'lemma_746">is_asm_index_rsn</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, j: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; <a href="#is_asm_index_168">is_asm_index</a> cert j -&gt; cert.<a href="#cDER_165">cDER</a>[j <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a>

  <span class="keyword">lemma</span> <a name="set_extensionality_singleton'lemma_750">set_extensionality_singleton</a>:
  <span class="keyword">forall</span> s: <a href="set.html#set_27">set</a> int, x: int.
    (<a href="set.html#mem_33">mem</a> x s /\ <span class="keyword">forall</span> y: int. y &lt;&gt; x -&gt; <span class="keyword">not</span> <a href="set.html#mem_33">mem</a> y s) -&gt; s = <a href="set.html#add_64">add</a> x <a href="set.html#empty_53">empty</a>

  <span class="keyword">lemma</span> <a name="is_asm_of_iff_mem'lemma_754">is_asm_of_iff_mem</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k j: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; j <a href="int.html#infix%20%3E=_26">&gt;=</a> 0 -&gt;
    <a href="#is_asm_of_308">is_asm_of</a> cert j (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) &lt;-&gt; <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[k].<a href="#a_set_141">a_set</a>

  <span class="keyword">lemma</span> <a name="a_set_singleton_iff_asm_of_form'lemma_759">a_set_singleton_iff_asm_of_form</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (cert.<a href="#cDER_165">cDER</a>[k].<a href="#a_set_141">a_set</a> = <a href="set.html#add_64">add</a> (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) <a href="set.html#empty_53">empty</a> &lt;-&gt;
     <a href="#is_asm_of_308">is_asm_of</a> cert (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) /\
     (<span class="keyword">forall</span> j: int.
        j &lt;&gt; (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>) -&gt; <span class="keyword">not</span> (<a href="#is_asm_of_308">is_asm_of</a> cert j (k <a href="int.html#infix%20+_19">+</a> <a href="#m_46">m</a>))))

  <span class="keyword">lemma</span> <a name="asm_data_none'lemma_767">asm_data_none</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#data_140">data</a> = <a href="#D_none_122">D_none</a>

  <span class="keyword">lemma</span> <a name="LemmaASM'lemma_775">LemmaASM</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k &lt;-&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDOM'lemma_785">LemmaDOM</a>:
  <span class="keyword">forall</span> c1 c2: <a href="#constraint_67">constraint</a>.
    (<a href="#is_constraint_73">is_constraint</a> c1 /\ <a href="#is_constraint_73">is_constraint</a> c2) -&gt;
    (<a href="#con_dom_con_232">con_dom_con</a> c1 c2 &lt;-&gt; <a href="#phi_DOM_constr_551">phi_DOM_constr</a> c1 c2)

                                <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="Lin_Next_Check'lemma_793">Lin_Next_Check</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.
    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#gen_con_dom_con_244">gen_con_dom_con</a> gen_con dc.<a href="#con_138">con</a> -&gt; <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
          gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
          (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
          all_nonneg
          (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
          all_nonpos
          (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>)

  <span class="keyword">lemma</span> <a name="Lin_intermed_valid_der'lemma_816">Lin_intermed_valid_der</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.
    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

    <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
    /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)
    /\ <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#gen_con_dom_con_244">gen_con_dom_con</a> gen_con dc.<a href="#con_138">con</a>

  <span class="keyword">lemma</span> <a name="Lin_Next_Check_valid_der_and'lemma_827">Lin_Next_Check_valid_der_and</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.
    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)
        /\ <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#gen_con_dom_con_244">gen_con_dom_con</a> gen_con dc.<a href="#con_138">con</a>  -&gt; <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
            gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
            all_nonneg
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
            all_nonpos
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>)

  <span class="keyword">lemma</span> <a name="Lin_Next_Check_valid_der_and_DOM'lemma_850">Lin_Next_Check_valid_der_and_DOM</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.
    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)
        /\ <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
            gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
            all_nonneg
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
            all_nonpos
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>)

  <span class="keyword">lemma</span> <a name="LemmaLINhelp'lemma_873">LemmaLINhelp</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int, weights: <a href="array.html#array_15">array</a> real.
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights) -&gt;
        (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
        <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; (<a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
          gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
          (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
          all_nonneg
          (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
          all_nonpos
          (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>))

  <span class="keyword">lemma</span> <a name="LemmaLIN_oneway'lemma_895">LemmaLIN_oneway</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaLin_otherway'lemma_903">LemmaLin_otherway</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaLin'lemma_913">LemmaLin</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#phi_DER_k_573">phi_DER_k</a> cert k &lt;-&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_Predicate'lemma_922">LemmaRND_Predicate</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, con: <a href="#constraint_67">constraint</a>.
    <a href="#is_cert_176">is_cert</a> cert -&gt; <a href="#phi_RND_559">phi_RND</a> cert con.<a href="#a_68">a</a> (con.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>) &lt;-&gt; <a href="#roundable_276">roundable</a> cert con

                                        <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="LemmaRND_C1_NotZero'lemma_929">LemmaRND_C1_NotZero</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, c1: <a href="#generalized_constraint_215">generalized_constraint</a>, c2: <a href="#constraint_67">constraint</a>, segno: <a href="#sign_54">sign</a>.
    <a href="#is_gen_con_test_251">is_gen_con_test</a> c1 /\ c1.<a href="#sgn_218">sgn</a> = <a href="#Sign_213">Sign</a> segno /\ <a href="#is_constraint_73">is_constraint</a> c2 /\ <a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert c1 c2
    /\ <span class="keyword">not</span> <a href="#is_absurdity_223">is_absurdity</a> {<a href="#a_68">a</a> = c1.<a href="#lhs_216">lhs</a>; <a href="#b_69">b</a> = c1.<a href="#rhs_217">rhs</a>; <a href="#s_70">s</a> = segno} -&gt; <span class="keyword">not</span> c2.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_Next_Check'lemma_935">LemmaRND_OneWay_Next_Check</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) -&gt; <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_Big_Check'lemma_952">LemmaRND_OneWay_Big_Check</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) -&gt;
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        )

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_All_Together_Unfold'lemma_991">LemmaRND_OneWay_All_Together_Unfold</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>
       /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
       /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) -&gt;
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_All_Together_Unfold_ALL'lemma_1032">LemmaRND_OneWay_All_Together_Unfold_ALL</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j)
        /\ (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) /\ <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt;
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_All_Together_Unfold_ALL_val'lemma_1073">LemmaRND_OneWay_All_Together_Unfold_ALL_val</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>
       /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)
       /\ (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) /\<a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt;
       (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_All_Together_Unfold_ALL_val_help'lemma_1114">LemmaRND_OneWay_All_Together_Unfold_ALL_val_help</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>
        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>
       /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights  /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\ <a href="#phi_ASM_509">phi_ASM</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_All_Together_Unfold_ALL_val_help_help'lemma_1155">LemmaRND_OneWay_All_Together_Unfold_ALL_val_help_help</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)
        /\ (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j)
        /\<a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt;  <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay'lemma_1168">LemmaRND_OneWay</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check'lemma_1177">LemmaRND_OtherWay_Next_Check</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ <a href="#phi_ASM_509">phi_ASM</a> cert k /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) -&gt; <a href="#val_ASM_348">val_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next_Next'lemma_1219">LemmaRND_OtherWay_Next_Check_Next_Next</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
        <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

            <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
            <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
            <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ <a href="#phi_ASM_509">phi_ASM</a> cert k /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) -&gt; (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)

        <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next'lemma_1258">LemmaRND_OtherWay_Next_Check_Next</a>:
        <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.
        <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
        <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <span class="keyword">let</span> sgn_prod =
        <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ <a href="#phi_ASM_509">phi_ASM</a> cert k /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\ <span class="comment">(* is absurdity *)</span>
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\ <span class="comment">(*domination part*)</span>
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (  <span class="comment">(* added extra case to fix the corner case*)</span>
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) -&gt; (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) /\ <a href="#val_ASM_348">val_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next_extra'lemma_1297">LemmaRND_OtherWay_Next_Check_Next_extra</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ <a href="#phi_ASM_509">phi_ASM</a> cert k /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\ <span class="comment">(* is absurdity *)</span>
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\ <span class="comment">(*domination part*)</span>
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (  <span class="comment">(* added extra case to fix the corner case*)</span>
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        )

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next_extra_extra'lemma_1338">LemmaRND_OtherWay_Next_Check_Next_extra_extra</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\
        (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next_phi'lemma_1379">LemmaRND_OtherWay_Next_Check_Next_phi</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_DER_k_573">phi_DER_k</a> cert k
         -&gt; (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
         (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) /\ <a href="#val_ASM_348">val_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next_Phi_Val'lemma_1393">LemmaRND_OtherWay_Next_Check_Next_Phi_Val</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#phi_DER_k_573">phi_DER_k</a> cert k
         -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay_Next_Check_Next_Phi_Val_Fin'lemma_1405">LemmaRND_OtherWay_Next_Check_Next_Phi_Val_Fin</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>  /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OtherWay'lemma_1414">LemmaRND_OtherWay</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

   <span class="keyword">lemma</span> <a name="LemmaRND'lemma_1422">LemmaRND</a>:
    <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> -&gt;
   (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k &lt;-&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

                                          <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="LemmaDIS_Oneway'lemma_1432">LemmaDIS_Oneway</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, c1 c2: <a href="#constraint_67">constraint</a>.
    <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#is_disjunction_298">is_disjunction</a> cert c1 c2 -&gt; <a href="#phi_DIS_564">phi_DIS</a> cert c1 c2)

  <span class="keyword">lemma</span> <a name="LemmaDIS_Otherway'lemma_1436">LemmaDIS_Otherway</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, c1 c2: <a href="#constraint_67">constraint</a>.
     <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#phi_DIS_564">phi_DIS</a> cert c1 c2 -&gt; <a href="#is_disjunction_298">is_disjunction</a> cert c1 c2)

  <span class="keyword">lemma</span> <a name="LemmaDIS'lemma_1442">LemmaDIS</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, c1 c2: <a href="#constraint_67">constraint</a>.
    <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#is_disjunction_298">is_disjunction</a> cert c1 c2 &lt;-&gt; <a href="#phi_DIS_564">phi_DIS</a> cert c1 c2)

                                          <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="LemmaUNS_OneWay_ASM'lemma_1449">LemmaUNS_OneWay_ASM</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaUNS_One_Direction'lemma_1457">LemmaUNS_One_Direction</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaUNS_Other_Direction'lemma_1465">LemmaUNS_Other_Direction</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
     <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaUNS'lemma_1475">LemmaUNS</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k &lt;-&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

                                          <span class="comment">(*helper lemmas*)</span>

  <span class="keyword">lemma</span> <a name="LemmaSol_One_Direction_ASM'lemma_1486">LemmaSol_One_Direction_ASM</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaSol_OneDir_Helper'lemma_1495">LemmaSol_OneDir_Helper</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.

     <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

         <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
         cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt;
         (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
         ( (cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Min_86">Min</a> -&gt;
         <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } dc.<a href="#con_138">con</a>)
         /\ (cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Max_87">Max</a> -&gt;
         <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } dc.<a href="#con_138">con</a>)
         ) -&gt;
         <span class="keyword">if</span> <a href="#p_451">p</a> cert <span class="keyword">then</span>
           <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } dc.<a href="#con_138">con</a>
         <span class="keyword">else</span>
           <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } dc.<a href="#con_138">con</a>

  <span class="keyword">lemma</span> <a name="LemmaSol_OneDir_Helper_OtherWay'lemma_1515">LemmaSol_OneDir_Helper_OtherWay</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.

     <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

         <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
         cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt;
         (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
         (<span class="keyword">if</span> <a href="#p_451">p</a> cert <span class="keyword">then</span>
            <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } dc.<a href="#con_138">con</a>
          <span class="keyword">else</span>
            <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\ <a href="#phi_DOM_constr_551">phi_DOM_constr</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } dc.<a href="#con_138">con</a>)
          -&gt; <span class="keyword">exists</span> sol: <a href="array.html#array_15">array</a> real. <a href="set.html#mem_33">mem</a> sol cert.<a href="#cSOL_164">cSOL</a> /\
          ((cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Min_86">Min</a> -&gt; <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Leq_55">Leq</a> } dc.<a href="#con_138">con</a>) /\
          (cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#sense_91">sense</a> = <a href="#Max_87">Max</a> -&gt; <a href="#con_dom_con_232">con_dom_con</a> { <a href="#a_68">a</a> = cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a>; <a href="#b_69">b</a> = <a href="#dot_75">dot</a> cert.<a href="#cOBJ_161">cOBJ</a>.<a href="#c_90">c</a> sol; <a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> } dc.<a href="#con_138">con</a>))

  <span class="keyword">lemma</span> <a name="LemmaSOL_valid_OneWay'lemma_1533">LemmaSOL_valid_OneWay</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaSOL_valid_OtherWay'lemma_1541">LemmaSOL_valid_OtherWay</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
     <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaSOL_valid'lemma_1550">LemmaSOL_valid</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k &lt;-&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

                                                      <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="LemmaDER_Oneway_together'lemma_1560">LemmaDER_Oneway_together</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>) -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_k_OneWay'lemma_1568">LemmaDER_k_OneWay</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperASM'lemma_1575">LemmaDER_helperASM</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperSol'lemma_1579">LemmaDER_helperSol</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperUns'lemma_1583">LemmaDER_helperUns</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_helper'lemma_1588">LemmaDER_helperLin_helper</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
        (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights) -&gt;
        <a href="#gen_con_dom_con_244">gen_con_dom_con</a> gen_con dc.<a href="#con_138">con</a> -&gt; (<a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
            gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
            all_nonneg
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
            all_nonpos
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>))

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_helper_phiASM'lemma_1613">LemmaDER_helperLin_helper_phiASM</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
        (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights) -&gt;
        <a href="#val_ASM_348">val_ASM</a> cert k /\ <a href="#gen_con_dom_con_244">gen_con_dom_con</a> gen_con dc.<a href="#con_138">con</a> -&gt; (<a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
            gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
            all_nonneg
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
            all_nonpos
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>)) /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_helper_phiASM_check'lemma_1638">LemmaDER_helperLin_helper_phiASM_check</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
        (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights) -&gt;
        <a href="#val_ASM_348">val_ASM</a> cert k /\ <a href="#gen_con_dom_con_244">gen_con_dom_con</a> gen_con dc.<a href="#con_138">con</a> /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) -&gt; (<a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
            gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
            all_nonneg
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
            all_nonpos
            (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>))  /\ <a href="#phi_ASM_509">phi_ASM</a> cert k /\ (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#d_47">d</a> /\ weights[j] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j total_k)

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_helper_phiASM_check_trans'lemma_1664">LemmaDER_helperLin_helper_phiASM_check_trans</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
        (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights) -&gt;
        <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt;  <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin'lemma_1674">LemmaDER_helperLin</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="is_asm_of_total_k_iff_mem_dc'lemma_1679">is_asm_of_total_k_iff_mem_dc</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>,  k j: int.
    0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (<a href="#is_asm_of_308">is_asm_of</a> cert j (Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a>) &lt;-&gt; <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[k].<a href="#a_set_141">a_set</a>)

  <span class="keyword">lemma</span> <a name="mem_a_set_iff_is_asm_of_any'lemma_1684">mem_a_set_iff_is_asm_of_any</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>,  i j: int.
    <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ <span class="keyword">not</span> (<a href="#in_range_127">in_range</a> i <a href="#m_46">m</a>) -&gt;
    (<a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a> &lt;-&gt; <a href="#is_asm_of_308">is_asm_of</a> cert j i)

  <span class="keyword">lemma</span> <a name="One_Direction'lemma_1691">One_Direction</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights
        /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ (<span class="keyword">forall</span> j. ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) j total_k) -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j total_k))
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)  -&gt;
        ( (<span class="keyword">forall</span> j:int.<a href="set.html#mem_33">mem</a> j dc.<a href="#a_set_141">a_set</a> &lt;-&gt; <span class="keyword">exists</span> i:int. weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k /\
         <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a>)
        /\
        (<span class="keyword">forall</span> i:int. weights[i] &lt;&gt; 0.0 -&gt;
        <a href="set.html#subset_42">subset</a> cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a> dc.<a href="#a_set_141">a_set</a>) ) -&gt; (<span class="keyword">forall</span> j: int. (<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j total_k) -&gt;
        (<a href="#is_asm_of_308">is_asm_of</a> cert j total_k &lt;-&gt;  <span class="keyword">exists</span> i: int.
       ((weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) j i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#is_asm_of_308">is_asm_of</a> cert j i)))

  <span class="keyword">lemma</span> <a name="Other_Direction'lemma_1710">Other_Direction</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights  /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>)
        /\ (<span class="keyword">forall</span> j. ((<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3E_24">&gt;</a>) j total_k) -&gt; <span class="keyword">not</span> <a href="#is_asm_of_308">is_asm_of</a> cert j total_k))
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)  -&gt;
        (<span class="keyword">forall</span> j: int. (<a href="#is_asm_index_168">is_asm_index</a> cert j /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) j total_k) -&gt;
        (<a href="#is_asm_of_308">is_asm_of</a> cert j total_k &lt;-&gt;  <span class="keyword">exists</span> i: int.
        ((weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) j i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#is_asm_of_308">is_asm_of</a> cert j i)))  -&gt;
        ( (<span class="keyword">forall</span> j:int. <a href="set.html#mem_33">mem</a> j dc.<a href="#a_set_141">a_set</a> &lt;-&gt; <span class="keyword">exists</span> i:int. weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k /\
         <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a>)
        /\
        (<span class="keyword">forall</span> i:int. weights[i] &lt;&gt; 0.0 /\ Int.(<a href="int.html#infix%20%3C=_25">&lt;=</a>) <a href="#m_46">m</a> i /\ Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k -&gt;
        <span class="keyword">forall</span> j:int. <a href="set.html#mem_33">mem</a> j cert.<a href="#cDER_165">cDER</a>[Int.(<a href="int.html#infix%20-_23">-</a>) i <a href="#m_46">m</a>].<a href="#a_set_141">a_set</a> -&gt; <a href="set.html#mem_33">mem</a> j dc.<a href="#a_set_141">a_set</a>) )

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRND_helper'lemma_1731">LemmaDER_helperRND_helper</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        (<a href="#rnd_gen_con_dom_con_292">rnd_gen_con_dom_con</a> cert (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>) /\ <a href="#val_ASM_348">val_ASM</a> cert k -&gt; (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRND_helper_helper'lemma_1772">LemmaDER_helperRND_helper_helper</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\
        <a href="#valid_DER_k_373">valid_DER_k</a> cert k /\ <a href="#val_ASM_348">val_ASM</a> cert k -&gt; (
        (<span class="keyword">not</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a> /\
        (
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        \/
        (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = dc.<a href="#con_138">con</a>.<a href="#a_68">a</a>[j]) /\
        (<span class="keyword">if</span> dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a> <span class="keyword">then</span> (all_nonneg /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#ceil_184">ceil</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3E=._78">&gt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>) <span class="keyword">else</span>
          (all_nonpos /\ (<a href="real.html#from_int_129">from_int</a> (<a href="real.html#floor_183">floor</a> gen_con.<a href="#rhs_217">rhs</a>)) <a href="real.html#infix%20%3C=._77">&lt;=.</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a>))
        )
        )
        ) \/  (
        (<span class="keyword">forall</span> j: int. <a href="#in_range_127">in_range</a> j <a href="#n_45">n</a> -&gt; gen_con.<a href="#lhs_216">lhs</a>[j] = 0.0) /\
        (<span class="keyword">if</span> all_nonneg <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3E._80">&gt;.</a> 0.0 <span class="keyword">else</span>
          <span class="keyword">if</span> all_nonpos <span class="keyword">then</span> gen_con.<a href="#rhs_217">rhs</a> <a href="real.html#infix%20%3C._79">&lt;.</a> 0.0 <span class="keyword">else</span> <span class="keyword">false</span>)
        )
        ) /\ <a href="#phi_RND_559">phi_RND</a> cert gen_con.<a href="#lhs_216">lhs</a> all_zero /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRnd'lemma_1812">LemmaDER_helperRnd</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRndAltogether'lemma_1816">LemmaDER_helperRndAltogether</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a>) -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRndAltogether_Altogether'lemma_1820">LemmaDER_helperRndAltogether_Altogether</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_k_OtherWay_Together'lemma_1825">LemmaDER_k_OtherWay_Together</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_k'lemma_1833">LemmaDER_k</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert j) -&gt;
    <a href="#valid_DER_k_373">valid_DER_k</a> cert k &lt;-&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k

                                                  <span class="comment">(*helper lemmas*)</span>

  <span class="keyword">lemma</span> <a name="LemmaDER_HelperAnother'lemma_1843">LemmaDER_HelperAnother</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>.
    <a href="#is_cert_176">is_cert</a> cert -&gt; (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k (Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>) -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k)  -&gt; (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k (Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>) -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k)

  <span class="keyword">lemma</span> <a name="LemmaDER_forward'lemma_1847">LemmaDER_forward</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#valid_DER_410">valid_DER</a> cert -&gt; <a href="#phi_DER_640">phi_DER</a> cert)

  <span class="keyword">lemma</span> <a name="LemmaDER_helperASM_OtherDirection'lemma_1849">LemmaDER_helperASM_OtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperSol_OtherDirection'lemma_1853">LemmaDER_helperSol_OtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a> -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperUns_OtherDirection'lemma_1857">LemmaDER_helperUns_OtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDir_help'lemma_1863">LemmaDER_helperLin_OtherDir_help</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\
        <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
        gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
        all_nonneg
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
        all_nonpos
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>)  -&gt; (<a href="#gen_con_dom_con_244">gen_con_dom_con</a> (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDir_help_help'lemma_1888">LemmaDER_helperLin_OtherDir_help_help</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>
        <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\
        <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
        gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
        all_nonneg
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
        all_nonpos
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) -&gt; (<a href="#gen_con_dom_con_244">gen_con_dom_con</a> (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k)

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDir_help_help_help'lemma_1914">LemmaDER_helperLin_OtherDir_help_help_help</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

     <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
     <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
     <span class="keyword">let</span> sgn_prod =
     <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

     <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>
         <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
         /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\
         <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
         gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
         (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
         all_nonneg
         (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
         all_nonpos
         (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#phi_ASM_509">phi_ASM</a> cert k
         -&gt; (<a href="#gen_con_dom_con_244">gen_con_dom_con</a> (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)
         /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#val_ASM_348">val_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDir_help_help_help_extra'lemma_1941">LemmaDER_helperLin_OtherDir_help_help_help_extra</a> :
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>
    <span class="keyword">let</span> sgn_prod =
    <span class="keyword">fun</span> i -&gt; weights[i] <a href="real.html#infix%20*._71">*.</a> (<a href="real.html#from_int_129">from_int</a> (<a href="#sign_to_int_59">sign_to_int</a> (<a href="#get_constraint_220">get_constraint</a> cert i).<a href="#s_70">s</a>)) <span class="keyword">in</span>

        <span class="keyword">let</span> all_nonneg : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3E=._78">&gt;=.</a> 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_zero   : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i = 0.0 <span class="keyword">in</span>
        <span class="keyword">let</span> all_nonpos : bool = <span class="keyword">forall</span> i: int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> -&gt; sgn_prod i <a href="real.html#infix%20%3C=._77">&lt;=.</a> 0.0 <span class="keyword">in</span>

    <span class="keyword">let</span> gen_con : <a href="#generalized_constraint_215">generalized_constraint</a> = <a href="#get_lin_comb_254">get_lin_comb</a> cert weights <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ <a href="#phi_DER_k_573">phi_DER_k</a> cert k
        -&gt;  <a href="#phi_DOM_expanded_535">phi_DOM_expanded</a>
        gen_con.<a href="#lhs_216">lhs</a> dc.<a href="#con_138">con</a>.<a href="#a_68">a</a> gen_con.<a href="#rhs_217">rhs</a> dc.<a href="#con_138">con</a>.<a href="#b_69">b</a> all_zero
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Eq_57">Eq</a>)
        all_nonneg
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Geq_56">Geq</a>)
        all_nonpos
        (dc.<a href="#con_138">con</a>.<a href="#s_70">s</a> = <a href="#Leq_55">Leq</a>) /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#phi_ASM_509">phi_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDir_help_help_help_extra_extra'lemma_1967">LemmaDER_helperLin_OtherDir_help_help_help_extra_extra</a> :
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> total_k = Int.(<a href="int.html#infix%20+_19">+</a>) k <a href="#m_46">m</a> <span class="keyword">in</span>
    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\ <a href="#phi_DER_k_573">phi_DER_k</a> cert k
        -&gt; (<a href="#gen_con_dom_con_244">gen_con_dom_con</a> (<a href="#get_lin_comb_254">get_lin_comb</a> cert weights) dc.<a href="#con_138">con</a>)
        /\ (<span class="keyword">forall</span> i:int. <a href="#in_range_127">in_range</a> i <a href="#d_47">d</a> /\ weights[i] &lt;&gt; 0.0 -&gt; Int.(<a href="int.html#infix%20%3C_21">&lt;</a>) i total_k) /\ <a href="#val_ASM_348">val_ASM</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDir_help_help_help_fin'lemma_1980">LemmaDER_helperLin_OtherDir_help_help_help_fin</a>:
  <span class="keyword">forall</span> cert:<a href="#certificate_159">certificate</a>, k:int, weights: <a href="array.html#array_15">array</a> real.

    <span class="keyword">let</span> dc = cert.<a href="#cDER_165">cDER</a>[k] <span class="keyword">in</span>

        <a href="#is_cert_176">is_cert</a> cert  /\ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a>
        /\ dc.<a href="#data_140">data</a> = <a href="#D_lin_comb_123">D_lin_comb</a> weights /\ (0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a>) /\
        <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperLin_OtherDirection'lemma_1990">LemmaDER_helperLin_OtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaRND_OneWay_phi'lemma_1995">LemmaRND_OneWay_phi</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert j) -&gt;
    <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_k_Phi_oneway'lemma_2003">LemmaDER_k_Phi_oneway</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt;
    (<span class="keyword">forall</span> j: int. 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> j <a href="int.html#infix%20%3C_21">&lt;</a> k -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert j) -&gt;
    <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRnd_OtherDirection'lemma_2010">LemmaDER_helperRnd_OtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> -&gt;  <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRndAltogether_OtherDirection'lemma_2015">LemmaDER_helperRndAltogether_OtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k:int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; (cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Asm_115">Asm</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Rnd_117">Rnd</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Uns_118">Uns</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Lin_116">Lin</a> \/ cert.<a href="#cDER_165">cDER</a>[k].<a href="#rsn_139">rsn</a> = <a href="#Sol_119">Sol</a>) -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_helperRnd_OtherDirectionFinal'lemma_2019">LemmaDER_helperRnd_OtherDirectionFinal</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>, k: int.
    <a href="#is_cert_176">is_cert</a> cert -&gt; 0 <a href="int.html#infix%20%3C=_25">&lt;=</a> k <a href="int.html#infix%20%3C_21">&lt;</a> <a href="#d_47">d</a> <a href="int.html#infix%20-_23">-</a> <a href="#m_46">m</a> -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k

  <span class="keyword">lemma</span> <a name="LemmaDER_HelperOtherDirection'lemma_2023">LemmaDER_HelperOtherDirection</a>:
  <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>.
    <a href="#is_cert_176">is_cert</a> cert -&gt; (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k (Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>) -&gt; <a href="#phi_DER_k_573">phi_DER_k</a> cert k)  -&gt; (<span class="keyword">forall</span> k: int. <a href="#in_range_127">in_range</a> k (Int.(<a href="int.html#infix%20-_23">-</a>) <a href="#d_47">d</a> <a href="#m_46">m</a>) -&gt; <a href="#valid_DER_k_373">valid_DER_k</a> cert k)

  <span class="keyword">lemma</span> <a name="LemmaDER_OtherWay'lemma_2027">LemmaDER_OtherWay</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#phi_DER_640">phi_DER</a> cert -&gt; <a href="#valid_DER_410">valid_DER</a> cert)

  <span class="keyword">lemma</span> <a name="LemmaDER'lemma_2031">LemmaDER</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#valid_DER_410">valid_DER</a> cert &lt;-&gt; <a href="#phi_DER_640">phi_DER</a> cert)

                                           <span class="comment">(*helper lemmas*)</span>
  <span class="keyword">lemma</span> <a name="MainTheorem_OneWay'lemma_2036">MainTheorem_OneWay</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#valid_431">valid</a> cert -&gt; <a href="#phi_664">phi</a> cert)

  <span class="keyword">lemma</span> <a name="MainTheorem_OtherWay'lemma_2038">MainTheorem_OtherWay</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#phi_664">phi</a> cert -&gt; <a href="#valid_431">valid</a> cert)

  <span class="keyword">goal</span> <a name="MainTheorem_2042">MainTheorem</a>: <span class="keyword">forall</span> cert: <a href="#certificate_159">certificate</a>. <a href="#is_cert_176">is_cert</a> cert -&gt; (<a href="#valid_431">valid</a> cert &lt;-&gt; <a href="#phi_664">phi</a> cert)

<span class="keyword">end</span></pre>

</div>
<hr>
<p>Generated by why3doc 1.7.2</p>
</body>
</html>
